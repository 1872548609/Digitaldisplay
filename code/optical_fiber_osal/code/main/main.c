/**************************************************************************************************
Filename:       iot_main.c
Revised:        $Date: 2019-8-20 15:35
Revision:       $Revision: V1.0.0

Description:

Copyright 2021 uwaycon. All rights reserved.
                                                
**************************************************-*****************^******************************/
#include "main.h"

#ifdef __cplusplus
extern "C"
{
#endif

#ifdef _MAIN_H
/*************************************************-*************************************************
*                                               NOTE
**************************************************-*****************^******************************/
//-- source insight use UTF-8 to encode, File->Reload As Encoding...->UTF-8
//-- source insight set default encode, Option->Preferences->Files->Default encoding->UTF-8

/*************************************************-*************************************************
*                                             INCLUDES
**************************************************-*****************^******************************/

/*************************************************-*************************************************
*                                               MACRO
**************************************************-*****************^******************************/

/*************************************************-*************************************************
*                                          CONSTANT DEFINED
**************************************************-*****************^******************************/

/*************************************************-*************************************************
*                                           STRUCT DEFINED
**************************************************-*****************^******************************/

/*************************************************-*************************************************
*                                          GLOBAL VARIABLES
**************************************************-*****************^******************************/

/*************************************************-*************************************************
*                                          LOCAL VARIABLES
**************************************************-*****************^******************************/

/*************************************************-*************************************************
*                                          LOCAL VARIABLES
**************************************************-*****************^******************************/

/*************************************************-*************************************************
*                                             FUNCTIONS
**************************************************-*****************^******************************/

/*************************************************-*************************************************
*                                             FUNCTIONS
**************************************************-*****************^******************************/

int main(void)
{	
    // 关闭所有中断（防止初始化过程中被中断打断）
    osal_int_disable( INTS_ALL );

    // 初始化滴答
    iot_driver_clock_init();
	
    // 冷初始化（硬件初始化）板载I/O（如GPIO、外设时钟等）
    InitBoard( OB_COLD );

    // 初始化硬件抽象层（HAL）驱动（如定时器、ADC、SPI等）
    HalDriverInit();
 
    // **初始化操作系统抽象层（OSAL：Operating System Abstraction Layer）
    osal_init_system();

    // 重新开启所有中断（初始化完成，允许中断响应）
    osal_int_enable( INTS_ALL );

    // 准备就绪后的板载最终初始化（如启用高级外设功能）
    InitBoard( OB_READY );

    // **启动OSAL调度系统（从此函数不再返回，进入任务轮询或事件驱动模式）
    osal_start_system(); // No Return from here

    // 理论上不会执行到这里（防止编译器警告）
    return 0;
}


/*************************************************-*************************************************
*                                                END
**************************************************-*****************^******************************/
#ifdef __cplusplus
}
#endif
#endif 
 
